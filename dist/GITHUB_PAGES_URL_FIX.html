<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub Pages URL Fix Guide - Sweet Moment</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem;
    }
    h1 {
      color: #8B5CF6;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 0.5rem;
    }
    h2 {
      color: #5B21B6;
      margin-top: 2rem;
    }
    pre, code {
      background-color: #f5f5f5;
      border-radius: 3px;
      padding: 0.2rem 0.4rem;
      font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.9em;
    }
    pre {
      padding: 1rem;
      overflow-x: auto;
    }
    pre code {
      padding: 0;
      background-color: transparent;
    }
    .container {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 2rem;
    }
    .warning {
      background-color: #FEF3C7;
      border-left: 4px solid #F59E0B;
      padding: 1rem;
      margin: 1.5rem 0;
      border-radius: 0 4px 4px 0;
    }
    .correct {
      color: #10B981;
    }
    .incorrect {
      color: #EF4444;
      text-decoration: line-through;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>GitHub Pages URL Fix Guide for Sweet Moment</h1>
    <p>This guide explains how the URL fix for GitHub Pages works and how to troubleshoot any issues.</p>

    <h2>Background: The GitHub Pages URL Problem</h2>
    <p>When deploying a Single Page Application (SPA) to GitHub Pages, two main issues occur:</p>
    <ol>
      <li>GitHub Pages doesn't support server-side routing, so navigating directly to <code>/about</code> would return a 404</li>
      <li>For project sites (not using a custom domain), URLs must include the repository name: <code>https://username.github.io/repo-name/</code></li>
    </ol>

    <p>Additionally, we discovered a specific issue with the Sweet Moment site where the repository name was being duplicated in navigation URLs:</p>
    <pre><code>https://username.github.io/sweet-moment/#/sweet-moment/page
                                     ^ Repository     ^ Duplicated</code></pre>
    <p>This duplication causes 404 errors because the application tries to find content at an invalid path.</p>

    <h2>How Our Fix Works</h2>
    <p>The solution implemented in this static site generator addresses all these issues:</p>

    <h3>1. Hash-Based Routing</h3>
    <p>We use hash-based routing (<code>/#/</code> instead of <code>/</code>), which keeps all navigation on the client side without requiring server changes:</p>
    <pre><code>https://username.github.io/sweet-moment/#/menu</code></pre>

    <h3>2. Repository Name Detection &amp; Configuration</h3>
    <p>The application automatically detects the repository name from the URL or uses the one configured during export.</p>

    <h3>3. Duplicate Repository Path Correction</h3>
    <p>Our key fix: When the application detects a URL with a duplicate repository name in the hash path, it automatically rewrites it:</p>
    <pre><code>// Special fix for duplicate repository segments in URLs
if (window.location.hash && window.location.hash.indexOf('/#/' + window.REPO_NAME + '/') === 0) {
  console.warn("[Router Fix] Detected duplicate repository segment in hash URL");
  const fixedHash = window.location.hash.replace('/#/' + window.REPO_NAME + '/', '/#/');
  console.log("[Router Fix] Correcting URL: " + window.location.hash + " â†’ " + fixedHash);
  window.location.replace(
    window.location.protocol + '//' + 
    window.location.hostname + 
    (window.location.port ? ':' + window.location.port : '') +
    window.location.pathname + fixedHash
  );
}</code></pre>

    <h3>4. Enhanced 404.html Page</h3>
    <p>The 404.html page contains special logic to handle direct navigation to any route:</p>
    <ol>
      <li>It parses the URL to extract the intended path</li>
      <li>It detects and removes duplicate repository segments</li>
      <li>It redirects to the proper hash-based URL</li>
    </ol>

    <h2>Troubleshooting GitHub Pages URLs</h2>
    <p>If you're experiencing URL issues after deploying to GitHub Pages:</p>
    <ol>
      <li><strong>Check the Console:</strong> Open the browser's developer tools (F12) and check for any router-related logs or errors.</li>
      <li><strong>Verify Repository Name:</strong> Make sure your repository name in GitHub settings matches what's configured in the static site.</li>
      <li><strong>Observe URL Transformations:</strong> When clicking links, watch the URL bar to see if proper transformations occur.</li>
      <li><strong>Try Direct Navigation:</strong> Test deep linking by directly entering a URL like:
      <pre><code>https://username.github.io/sweet-moment/#/menu</code></pre></li>
      <li><strong>Clear Browser Cache:</strong> Sometimes the browser caches old redirection logic.</li>
    </ol>

    <div class="warning">
      <strong>Important:</strong> If the repository name in your GitHub settings doesn't match the one used when generating the static export, you'll need to manually update the <code>window.REPO_NAME</code> variable in the index.html and 404.html files.
    </div>

    <h2>Technical Implementation Details</h2>
    <p>Our URL fix is implemented in three key files:</p>
    <ol>
      <li><strong>index.html:</strong> Contains the main router fix script that corrects navigation while using the site</li>
      <li><strong>404.html:</strong> Contains special logic to handle direct navigation to any URL</li>
      <li><strong>README.md:</strong> Contains instructions for proper deployment and troubleshooting</li>
    </ol>

    <h2>Custom Domain Configuration</h2>
    <p>If you're using a custom domain, the URL structure simplifies to:</p>
    <pre><code>https://your-domain.com/#/page</code></pre>
    <p>The router automatically detects custom domains and adjusts behavior accordingly.</p>

    <hr>
    <p><em>Generated by the Sweet Moment Static Site Generator</em></p>
  </div>
</body>
</html>